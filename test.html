<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Extension Test Page</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    
    h1 {
      color: #333;
    }
    
    .test-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .chat-container {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      background: #fafafa;
      min-height: 300px;
    }
    
    .chat-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .chat-item {
      padding: 15px;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .chat-item:hover {
      background: #f0f0f0;
    }
    
    .chat-item.unread {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
    }
    
    .message-list {
      min-height: 200px;
      max-height: 400px;
      overflow-y: auto;
      padding: 20px;
      background: white;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .message-text {
      padding: 10px 15px;
      margin: 10px 0;
      border-radius: 18px;
      max-width: 70%;
    }
    
    .message-text.incoming {
      background: #e0e0e0;
      align-self: flex-start;
    }
    
    .message-text.outgoing {
      background: #2196f3;
      color: white;
      align-self: flex-end;
      margin-left: auto;
    }
    
    .message-input-container {
      display: flex;
      gap: 10px;
    }
    
    .message-input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 20px;
      outline: none;
    }
    
    .send-button {
      padding: 10px 20px;
      background: #2196f3;
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
    }
    
    .send-button:hover {
      background: #1976d2;
    }
    
    .notification-badge {
      display: inline-block;
      background: red;
      color: white;
      padding: 2px 6px;
      border-radius: 10px;
      font-size: 12px;
      margin-left: 10px;
    }
    
    .controls {
      margin-top: 20px;
      display: flex;
      gap: 10px;
    }
    
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background: #4caf50;
      color: white;
    }
    
    button:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <h1>ðŸ§ª Seeking Chat Automation - Test Page</h1>
  <p>This page simulates a chat interface for testing the extension. Install the extension and navigate here to test functionality.</p>
  
  <div class="test-section">
    <h2>Chat List</h2>
    <div class="chat-list" id="chatList">
      <div class="chat-item unread" data-chat-id="1">
        <strong>Alice</strong>
        <span class="notification-badge">1</span>
        <div style="color: #666; font-size: 14px;">Hey there! How are you?</div>
      </div>
      <div class="chat-item" data-chat-id="2">
        <strong>Bob</strong>
        <div style="color: #666; font-size: 14px;">Last message...</div>
      </div>
      <div class="chat-item unread" data-chat-id="3">
        <strong>Carol</strong>
        <span class="notification-badge">2</span>
        <div style="color: #666; font-size: 14px;">Would you like to meet for coffee?</div>
      </div>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Active Chat</h2>
    <div class="chat-container">
      <div class="message-list" id="messageList">
        <div class="message-text incoming">Hello! How's your day going?</div>
        <div class="message-text outgoing">Hi! It's going great, thanks for asking!</div>
        <div class="message-text incoming">That's wonderful! Would you like to grab coffee sometime?</div>
      </div>
      
      <div class="message-input-container">
        <input type="text" class="message-input" id="messageInput" placeholder="Type a message...">
        <button class="send-button" id="sendButton">Send</button>
      </div>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Test Controls</h2>
    <div class="controls">
      <button onclick="addNewMessage()">Simulate New Message</button>
      <button onclick="markAsUnread()">Mark Chat as Unread</button>
      <button onclick="clearMessages()">Clear Messages</button>
      <button onclick="testMutations()">Test DOM Mutations</button>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Extension Status</h2>
    <div id="extensionStatus">
      <p>Check if the extension is detecting this page...</p>
      <p>Open the browser console to see extension logs.</p>
    </div>
  </div>
  
  <script>
    // Test functions
    function addNewMessage() {
      const messages = [
        "Hi there! How are you doing today?",
        "Would you like to meet for dinner this weekend?",
        "I love coffee! What's your favorite place?",
        "Tell me more about yourself!",
        "That sounds interesting, when are you available?"
      ];
      
      const randomMessage = messages[Math.floor(Math.random() * messages.length)];
      const messageList = document.getElementById('messageList');
      
      const newMessage = document.createElement('div');
      newMessage.className = 'message-text incoming';
      newMessage.textContent = randomMessage;
      messageList.appendChild(newMessage);
      
      // Scroll to bottom
      messageList.scrollTop = messageList.scrollHeight;
      
      // Mark chat as unread
      const firstChat = document.querySelector('.chat-item');
      firstChat.classList.add('unread');
      
      console.log('[Test] New message added:', randomMessage);
    }
    
    function markAsUnread() {
      const chats = document.querySelectorAll('.chat-item');
      const randomChat = chats[Math.floor(Math.random() * chats.length)];
      randomChat.classList.add('unread');
      
      // Add notification badge if not exists
      if (!randomChat.querySelector('.notification-badge')) {
        const badge = document.createElement('span');
        badge.className = 'notification-badge';
        badge.textContent = '1';
        randomChat.appendChild(badge);
      }
      
      console.log('[Test] Marked chat as unread');
    }
    
    function clearMessages() {
      const messageList = document.getElementById('messageList');
      messageList.innerHTML = '<div class="message-text incoming">Chat cleared. Send a new message to start!</div>';
      console.log('[Test] Messages cleared');
    }
    
    function testMutations() {
      // Simulate various DOM mutations
      setTimeout(() => {
        const chat = document.createElement('div');
        chat.className = 'chat-item unread';
        chat.innerHTML = '<strong>New User</strong><span class="notification-badge">1</span>';
        document.getElementById('chatList').appendChild(chat);
        console.log('[Test] Added new chat via mutation');
      }, 1000);
      
      setTimeout(() => {
        addNewMessage();
        console.log('[Test] Added message via mutation');
      }, 2000);
    }
    
    // Simulate chat functionality
    document.getElementById('sendButton').addEventListener('click', () => {
      const input = document.getElementById('messageInput');
      const message = input.value.trim();
      
      if (message) {
        const messageList = document.getElementById('messageList');
        const newMessage = document.createElement('div');
        newMessage.className = 'message-text outgoing';
        newMessage.textContent = message;
        messageList.appendChild(newMessage);
        
        input.value = '';
        messageList.scrollTop = messageList.scrollHeight;
        
        console.log('[Test] Message sent:', message);
      }
    });
    
    // Enter key to send
    document.getElementById('messageInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('sendButton').click();
      }
    });
    
    // Chat item click
    document.querySelectorAll('.chat-item').forEach(item => {
      item.addEventListener('click', () => {
        // Remove unread status
        item.classList.remove('unread');
        const badge = item.querySelector('.notification-badge');
        if (badge) badge.remove();
        
        // Load chat (simulation)
        console.log('[Test] Opened chat:', item.querySelector('strong').textContent);
      });
    });
    
    // Log page ready
    console.log('[Test Page] Ready for extension testing');
    console.log('[Test Page] Try the following:');
    console.log('1. Install and enable the extension');
    console.log('2. Click "Simulate New Message" to test detection');
    console.log('3. Check if the extension responds automatically');
    console.log('4. View extension logs in the console');
  </script>
</body>
</html>